tools:
  - script: edxpipelines/pipelines/cd_programs_multistage.py
    input_files:
      - &tools-admin "../gomatic-secure/gocd/vars/tools/admin.yml"
      - "../gomatic-secure/gocd/vars/tools/loadtest-multistage-programs.yml"
    enabled: False

  ## Start of 'Janitors' pipeline group

  #ASG cleanup for edge
  - script: edxpipelines/pipelines/asg_cleanup.py
    input_files:
      - *tools-admin
      - &edge-deployment "../gomatic-secure/gocd/vars/tools/deployments/edge.yml"
      - "../gomatic-secure/gocd/vars/tools/asg-cleanup-edge.yml"
    enabled: True

  #ASG cleanup for edx
  - script: edxpipelines/pipelines/asg_cleanup.py
    input_files:
      - *tools-admin
      - &edx-deployment "../gomatic-secure/gocd/vars/tools/deployments/edx.yml"
      - "../gomatic-secure/gocd/vars/tools/asg-cleanup-edx.yml"
    enabled: True

  #ASG cleanup for mckinsey
  - script: edxpipelines/pipelines/asg_cleanup.py
    input_files:
      - *tools-admin
      - &mckinsey-deployment "../gomatic-secure/gocd/vars/tools/deployments/mckinsey.yml"
      - "../gomatic-secure/gocd/vars/tools/asg-cleanup-mckinsey.yml"
    enabled: True
  # End of 'Janitors' pipeline group

  - script: edxpipelines/pipelines/build_edxapp_ami.py
    input_files:
      - *tools-admin
      - "../gomatic-secure/gocd/vars/tools/build-edxapp-ami.yml"
    enabled: False

  ## Start of 'deploy' pipeline group
  - script: edxpipelines/pipelines/deploy_ami.py
    input_files:
      - *tools-admin
      - *edx-deployment
      - "../gomatic-secure/gocd/vars/tools/deploy_edx_ami.yml"
    enabled: True

  - script: edxpipelines/pipelines/deploy_ami.py
    input_files:
      - *tools-admin
      - *edge-deployment
      - "../gomatic-secure/gocd/vars/tools/deploy_edge_ami.yml"
    enabled: True

  - script: edxpipelines/pipelines/deploy_ami.py
    input_files:
      - *tools-admin
      - *mckinsey-deployment
      - "../gomatic-secure/gocd/vars/tools/deploy_mckinsey_ami.yml"
    enabled: True

  - script: edxpipelines/pipelines/deploy_gomatic_pipelines.py
    input_files:
      - *tools-admin
      - "../gomatic-secure/gocd/vars/tools/deploy_gomatic_piplines.yml"
    enabled: True

  ## end of deploy pipeline group

  - script: edxpipelines/pipelines/deploy_marketing_site.py
    input_files:
      - *tools-admin
      - "../gomatic-secure/gocd/vars/tools/deploy_drupal.yml"
    enabled: False

  # CD to loadtest of edxapp
  - script: edxpipelines/pipelines/cd_edxapp.py
    input_files:
      - *tools-admin
      - "../gomatic-secure/gocd/vars/tools/environment-deployment-play/loadtest-edx-edxapp.yml"
      - "../gomatic-secure/gocd/vars/tools/environment-deployments/loadtest-edx.yml"
      - "../gomatic-secure/gocd/vars/tools/plays/edxapp.yml"
      - "../gomatic-secure/gocd/vars/tools/deployments/edx.yml"
    enabled: True


  ## start of api-manager pipeline group

  # build
  - script: edxpipelines/pipelines/api_build.py
    input_files:
      - *tools-admin
      - "../gomatic-secure/gocd/vars/tools/build-edx-api.yml"
    enabled: True

  # stage deploy
  - script: edxpipelines/pipelines/api_deploy.py
    input_files:
      - *tools-admin
      - "../gomatic-secure/gocd/vars/tools/stage-edx-api.yml"
    enabled: True

  # prod deploy
  - script: edxpipelines/pipelines/api_deploy.py
    input_files:
      - *tools-admin
      - "../gomatic-secure/gocd/vars/tools/prod-edx-api.yml"
    enabled: True

    ## end of api-manager pipeline group

sandbox:
  - script: edxpipelines/pipelines/cd_programs_multistage.py
    input_files:
      - &sandbox-admin "../gomatic-secure/gocd/vars/sandbox/admin.yml"
      - "../gomatic-secure/gocd/vars/sandbox/loadtest-multistage-programs.yml"
    enabled: True

  - script: edxpipelines/pipelines/deploy_marketing_site.py
    input_files:
      - *sandbox-admin
      - "../gomatic-secure/gocd/vars/sandbox/deploy_drupal.yml"
    enabled: False

  # CD to loadtest of edxapp
  - script: edxpipelines/pipelines/cd_edxapp.py
    input_files:
      - *tools-admin
      - "../gomatic-secure/gocd/vars/sandbox/loadtest-edxapp.yml"
    enabled: False
